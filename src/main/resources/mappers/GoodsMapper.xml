<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.panda.mapper.GoodsMapper">

	
	<!-- 상품 등록(user_nick 빠짐) -->
	<insert id="createGoods">
		insert into goods(goods_category,goods_title,goods_condition,goods_price,goods_discount,goods_detail,goods_refund,goods_trade,uploadFile,thumbnail)
		values(#{goods_category},#{goods_title},#{goods_condition},#{goods_price},#{goods_discount},#{goods_detail},#{goods_refund},#{goods_trade},#{uploadFile},#{thumbnail})
	</insert> 
	
	<!-- 상품 목록(all) -->
	<select resultType="GoodsVO" id="listAll">
		select * from goods 
		<if test="k!=null">
			where goods_title like concat('%',#{k},'%')
			and user_addr=#{l}
		</if>
		<if test="k==null and l!=null">
			where user_addr=#{l}
		</if>
		<if test="s==0">
			order by goods_date desc
		</if>
		<if test="s==1">
			order by goods_price desc
		</if>
		<if test="s==2">
			order by goods_price asc
		</if>
		<if test="s==3">
			order by viewcount desc
		</if>
		
	</select>
		
	<!-- 글 조회수 1증가 -->
 	<update id="updateViewcnt">
 		update goods set viewcount = viewcount+1 
 		where goods_no=#{goods_no} 
 	</update>
 	
 	<!-- 글번호(goods_no) 글정보 모두 조회 -->
 	<select id="getGoods" resultType="com.panda.domain.GoodsVO">
 		select * from goods where goods_no = #{goods_no}
 	</select>
 	
 	<!-- 글정보 수정 -->
 	<update id="updateGoods">
 		update goods set goods_category=#{goods_category},goods_title=#{goods_title},goods_condition=#{goods_condition},goods_price=#{goods_price},
 		goods_discount=#{goods_discount},goods_detail=#{goods_detail},goods_refund=#{goods_refund},uploadFile=#{uploadFile}
 		where goods_no=#{goods_no}
 	</update>
 	
 	<!-- 글정보 삭제 -->
 	<delete id="removeGoods">
 		delete from goods where goods_no = #{goods_no }
 	</delete>
	

	<!-- 게시판 글전체 개수 -->
   <select id="totalcount" resultType="int">
        select count(goods_no) from goods_no  
   </select>


</mapper>